# OCanada-TVNews  
### A Two-Year Dataset for Gender and Topic Diversity in Canadian TV News Broadcasts  
**Zeynep Pehlivan Â· McGill University**

Accepted at ICWSM 2025  
Dataset: [FigShare - DOI](https://figshare.com/s/3cd465d04ff4dda93390)  

---

## Overview

This repository provides the full codebase for processing and analyzing the **OCanada-TVNews** dataset, a bilingual, two-year dataset of Canadian TV news broadcast videos sourced from YouTube. It also includes modular tools to help you **generate your own annotated dataset** from any public YouTube playlist â€” extracting video metadata, performing speaker diarization, gender detection, topic classification, and building rich structured outputs ready for analysis.

![cr_pipeline.png](images/cr_pipeline.png)

It includes tools for:

- **Speaker Diarization** (via PyAnnote)
- **Gender Classification** (via Wav2Vec2)
- **Topic Classification** (via a multilingual IPTC topic model)
- **YouTube Metadata Extraction** (view counts, comments, etc.)

Each video is processed to generate structured JSON outputs that contain segmented transcripts, speaker metadata, gender and topic annotations, and platform-level metadata for downstream analysis.


---

## Installation

```bash 
git clone https://github.com/yourusername/ocanada-tvnews.git
cd ocanada-tvnews
pip install -r pipeline/requirements.txt
```

## Usage

### 1. Extract Video IDs from YouTube Playlist
This generates a list of video IDs with their publication dates as input to the pipeline.
```bash 
python pipeline/youtube_data_api.py \
  --playlist_id YOUR_PLAYLIST_ID \
  --api_key YOUR_API_KEY \
  --output YOUR_OUTPUT_FILE_NAME

```
### 2.Run the Full Processing Pipeline
This performs diarization, gender detection, topic labeling, and transcript segmentation. Video ids are red from INPUT_FOLDER which is the output_folder of previsous script.
```bash 
python pipeline/run_pipeline.py \
  --hf_token YOUR_HUGGINGFACE_TOKEN \
  --input_folder INPUT_FOLDER


```
### 3.Extract videos metadata from Youtube Data API 
This extracts metadta from Youtube Data API.
```bash 
python pipeline/youtube_data_api.py \
  --input_file YOUR_INPUT_FILE_NAME \ #YOUR_OUTPUT_FILE_NAME from step 1
  --api_key YOUR_API_KEY \
  --output YOUR_OUTPUT_FILE_NAME
```

## Output Format

All outputs are saved under the `pipeline/output/` directory in the following structure:

- `videos/`: Downloaded video or audio files
- `diarization/`: RTTM files generated by PyAnnote for speaker turns
- `topics_gender/`: Combined outputs with speaker turns, gender, topic, and metadata
- `metadata/`: YouTube video-level metadata (views, likes, comments, etc.)

Each line in the final `.json` files inside `topics_gender/` contains:

```json
{
  "speaker": "SPEAKER_20",
  "start": 53.336,
  "end": 57.19,
  "duration": 3.854,
  "gender": 1,
  "gender_probability": 0.9941650033,
  "text": " wartime bombs buried deep beneath an Ottawa bog.",
  "date": 1729138503000,
  "video": "L7zQb-rwoEM",
  "id": "L7zQb-rwoEM",
  "channel": "CTVTheNationalNewsPlaylist",
  "presenter": 1,
  "group": 5,
  "topic": "conflict, war and peace",
  "topic_probability": 0.9534682631
}
```

## Dataset Access

The full dataset is publicly available on **FigShare**:

ðŸ”— [https://figshare.com/s/3cd465d04ff4dda93390](https://figshare.com/s/3cd465d04ff4dda93390)

### Contents

- `all_data.zip` â€” Final processed JSONs combining speaker turns, gender, topic, and metadata
- `diarization.zip` â€” RTTM files from PyAnnote speaker diarization
- `metadata.zip` â€” YouTube video-level metadata (views, likes, comments, publish date)

These files together allow for in-depth analysis of gender and topic diversity across two years of Canadian TV news, with fine-grained temporal and platform-level context.

## Citation

If you use this dataset or codebase, please cite the paper below:

```bibtex
@inproceedings{pehlivan2025ocanada,
  title     = {OCanada-TVNews: A Two-Year Dataset for Gender and Topic Diversity in Canadian TV News Broadcasts},
  author    = {Pehlivan, Zeynep},
  booktitle = {Proceedings of the International Conference on Web and Social Media (ICWSM)},
  year      = {2025}
}
```

## License

This repository is released under the **MIT License**.
The dataset uses publicly available YouTube content and complies with the platform's [Terms of Service](https://www.youtube.com/t/terms).
